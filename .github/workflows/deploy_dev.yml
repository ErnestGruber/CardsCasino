name: Deploy to Test Server

on:
    push:
        branches:
            - master

jobs:
    deploy:
        runs-on: ubuntu-latest
        steps:
          - name: Checkout Code
            uses: actions/checkout@v2

          - name: Deploy to Server
            uses: appleboy/ssh-action@master
            with:
                host: ${{ secrets.SERVER_IP }}
                username: github
                key: ${{ secrets.SSH_KEY }}
                script: |
                    cd /home/github/casino/CardsCasino
                    git pull git@github.com:ErnestGruber/CardsCasino.git master
                    pip install -r requirements.txt
                    uvicorn client_api:app --host 0.0.0.0 --port 8000
